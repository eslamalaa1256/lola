<!-- Ø§Ù„Ù‡ÙŠØ¯Ø± Ø§Ù„Ù…ÙˆØ­Ø¯ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ØµÙØ­Ø§Øª -->
<div class="top-bar">
  <a href="index.html" class="logo">LOLA</a>
  <div class="nav-actions">
    <input type="text" id="search-box" placeholder="Ø¨Ø­Ø«...">
    <div class="cart-icon" onclick="window.location.href='cart.html'">
      ðŸ›’<span class="cart-count" id="cart-count">0</span>
    </div>
    <div class="wishlist-icon" onclick="window.location.href='favorites.html'">
      â™¡<span class="wishlist-count" id="wishlist-count">0</span>
    </div>
    <a href="javascript:void(0)" id="loginBtn" onclick="doLogin()">ØªØ³Ø¬ÙŠÙ„ / Ø¯Ø®ÙˆÙ„</a>
    <a href="javascript:void(0)" id="userIcon" onclick="logout()" style="display:none;">ðŸ‘¤</a>
  </div>
</div>

<script>
// Ù†Ø¸Ø§Ù… Ù…ÙˆØ­Ø¯ Ù„Ù„Ù‡ÙŠØ¯Ø±
const unifiedHeader = {
  init() {
    this.updateCounts();
    this.updateAuthUI();
    this.bindEvents();
  },

  updateCounts() {
    const cart = JSON.parse(localStorage.getItem('cart')) || [];
    const wishlist = JSON.parse(localStorage.getItem('wishlist')) || [];
    
    document.getElementById('cart-count').innerText = cart.length;
    document.getElementById('wishlist-count').innerText = wishlist.length;
    
    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø¥Ø°Ø§ ÙƒØ§Ù† ØµÙØ±
    document.getElementById('cart-count').style.display = cart.length > 0 ? 'inline-block' : 'none';
    document.getElementById('wishlist-count').style.display = wishlist.length > 0 ? 'inline-block' : 'none';
  },

  updateAuthUI() {
    const user = localStorage.getItem('loggedInUser');
    const loginBtn = document.getElementById('loginBtn');
    const userIcon = document.getElementById('userIcon');
    
    if (user) {
      loginBtn.style.display = 'none';
      userIcon.style.display = 'flex';
      userIcon.title = `Ù…Ø±Ø­Ø¨Ø§Ù‹ ${user}`;
    } else {
      loginBtn.style.display = 'inline-block';
      userIcon.style.display = 'none';
    }
  },

  bindEvents() {
    // Ø§Ø³ØªÙ…Ø§Ø¹ Ù„ØªØºÙŠÙŠØ±Ø§Øª localStorage
    window.addEventListener('storage', () => {
      this.updateCounts();
    });

    // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 5 Ø«ÙˆØ§Ù†ÙŠ
    setInterval(() => {
      this.updateCounts();
      this.updateAuthUI();
    }, 5000);
  }
};

// Ø¯ÙˆØ§Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
function doLogin() {
  const username = prompt("Ø§Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„:");
  if (username && username.trim() !== "") {
    localStorage.setItem('loggedInUser', username);
    unifiedHeader.updateAuthUI();
  }
}

function logout() {
  localStorage.removeItem('loggedInUser');
  unifiedHeader.updateAuthUI();
  alert("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬");
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‡ÙŠØ¯Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
document.addEventListener('DOMContentLoaded', () => {
  unifiedHeader.init();
});
</script>
